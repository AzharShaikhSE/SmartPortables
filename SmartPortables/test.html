<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script src="http://code.jquery.com/jquery-latest.min.js"></script>
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">
//alert('hello');

//google.charts.load('current', {packages: ['corechart', 'bar']});
//google.charts.setOnLoadCallback(drawTitleSubtitle);


$(document).ready(function(){
  alert('hello');
  $.ajax({
    url: 'Datavisualization',
    dataType: 'JSON',
    //contentType: 'application/json',
    //data: JSON.stringify(),
    success: function(result){
      alert(typeof result);
      alert(result);
    //  var arr = JSON.parse(result);
    //  var arr = JSON.parse("[" + result + "]");
      //alert(typeof arr);
      //google.charts.load('visualization','1', { packages: ['barchart']});
      //google.charts.setOnLoadCallback(drawChart(result));
      google.charts.load('current', {packages: ['corechart', 'bar']});
      //google.charts.setOnLoadCallback(drawChart(result));
  //    google.charts.setOnLoadCallback(drawTitleSubtitle(result));
      google.charts.setOnLoadCallback(function () {
    //var array = loadData();
    drawTitleSubtitle(result);
});
    }
  });

function drawTitleSubtitle(arr) {
    alert(arr);
    arr = arr.replace(/'/g, '"');
//var data = google.visualization.arrayToDataTable(JSON.parse(datos));
      var data = google.visualization.arrayToDataTable(JSON.parse(arr));

      var materialOptions = {
        chart: {
          title: 'Population of Largest U.S. Cities',
          subtitle: 'Based on most recent and previous census data'
        },
        hAxis: {
          title: 'Total Population',
          minValue: 0,
        },
        vAxis: {
          title: 'City'
        },
        bars: 'horizontal'
      };
      var materialChart = new google.charts.Bar(document.getElementById('chart_div'));
      materialChart.draw(data, materialOptions);
    }
});
</script>

</head>
<body>
  <div id="chart_div"></div>
</body>
</html>
